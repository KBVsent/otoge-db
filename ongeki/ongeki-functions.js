const ongeki_chart_list={lev_bas:"BASIC",lev_adv:"ADVANCED",lev_exc:"EXPERT",lev_mas:"MASTER",lev_lnt:"LUNATIC"};var columns_params=[{displayTitle:"ID (system)",name:"id",data:"id",className:"id detail-hidden",visible:!1,searchable:!1},{displayTitle:"#",name:"index",data:"id",className:"id detail-hidden",data:function(e){return e.id},render:renderInWrapper(),width:"20px",searchable:!1,visible:!1},{displayTitle:"アルバムアート",name:"jacket",data:"image_url",className:"jacket detail-hidden",render:function(e){return'<span class="img-wrap"><img src="jacket/'+e+'"/></span>'},width:"50px",orderable:!1,searchable:!1},{displayTitle:"曲名",name:"title",data:"title",className:"title-artist detail-hidden",render:function(e,a,s){return"display"===a?'<div class="inner-wrap">'+("1"==s.bonus?'<span class="bonus">BONUS</span>':"")+'<span class="title">'+e+'</span><span class="dash hidden"> - </span><span class="artist-display hidden">'+s.artist+"</span></div>":"filter"===a?e:s.title_sort},width:"80vw"},{displayTitle:"曲名 (読み)",name:"title_sort",data:"title_sort",className:"title-sort",visible:!1,searchable:!1},{displayTitle:"アーティスト",name:"title_merged",data:"title",className:"artist detail-hidden",render:function(e,a,s){return"display"===a?'<div class="inner-wrap"><span class="artist-display hidden">'+s.artist+"</span></div>":s.title_sort}},{displayTitle:"アーティスト",name:"artist",data:"artist",className:"artist detail-hidden",visible:!1},{displayTitle:"BPM",name:"bpm",data:"bpm",className:"details bpm",searchable:!1,visible:!1},{displayTitle:"バージョン",name:"version",data:"version",className:"details version",filterable:!0,render:renderInWrapper(),customDropdownSortSource:"date",width:"12em"},{displayTitle:"ジャンル",name:"category",data:"category",className:"details category",render:renderInWrapper(),customDropdownSortSource:"category_id",filterable:!0},{displayTitle:"ジャンルID",name:"category_id",data:"category_id",width:"90px",visible:!1,searchable:!1},{displayTitle:"チャプターID",name:"chap_id",data:"chap_id",className:"chapter-id",visible:!1,searchable:!1},{displayTitle:"チャプター",name:"chap",data:function(e,a,s,t){return"sort"===a||"meta"===a?e.chap_id:parseChapId(e,!0)+e.chapter},className:"chapter",width:"15em",render:function(e,a,s){return"display"===a?'<div class="inner-wrap"><span class="chap-id-badge">'+parseChapId(s,!0)+'</span><span class="chap-name">'+s.chapter+"</span></div>":e},filterable:!0,visible:!1},{displayTitle:"属性",name:"enemy_type",data:"enemy_type",className:"chara type",render:function(e,a,s){return"display"===a?'<div class="inner-wrap"><span class="element-type-icon '+e.toLowerCase()+'"><span class="icon"></span><span class="label-text">'+e+"</span></span></div>":e},width:"40px",filterable:!0},{displayTitle:"キャラID",name:"chara_id",data:"chara_id",visible:!1,searchable:!1},{displayTitle:"相手キャラ",name:"character",data:"character",className:"chara character",render:function(e,a,s){return"display"===a?'<div class="inner-wrap">'+e+"</div>":e},customDropdownSortSource:"chara_id",width:"10em",filterable:!0},{displayTitle:"相手レベル",name:"enemy_lv",data:"enemy_lv",className:"chara enemy-lv",render:function(e,a,s){return"display"===a?'<div class="inner-wrap">Lv.'+e+"</div>":e},customDropdownSortSource:sortByLeadingZeros("enemy_lv"),width:"4em",searchable:!1},{displayTitle:"BASIC",name:"lev_bas",data:sortLevels("lev_bas"),className:"lv lv-bsc",render:renderLvNum("lev_bas"),customDropdownSortSource:sortByLeadingZeros("lev_bas"),reverseSortOrder:!0,width:"3rem",filterable:!flat_view},{displayTitle:"ADVANCED",name:"lev_adv",data:sortLevels("lev_adv"),className:"lv lv-adv",render:renderLvNum("lev_adv"),customDropdownSortSource:sortByLeadingZeros("lev_adv"),reverseSortOrder:!0,width:"3rem",filterable:!flat_view},{displayTitle:"EXPERT",name:"lev_exc",data:sortLevels("lev_exc"),className:"lv lv-exp",render:renderLvNum("lev_exc"),customDropdownSortSource:sortByLeadingZeros("lev_exc"),reverseSortOrder:!0,width:"3rem",filterable:!flat_view},{displayTitle:"MASTER",name:"lev_mas",data:sortLevels("lev_mas"),className:"lv lv-mas",render:renderLvNum("lev_mas"),customDropdownSortSource:sortByLeadingZeros("lev_mas"),reverseSortOrder:!0,width:"3rem",filterable:!flat_view},{displayTitle:"LUNATIC",name:"lev_lnt",data:sortLevels("lev_lnt"),className:"lv lv-lnt",render:renderLvNum("lev_lnt"),customDropdownSortSource:sortByLeadingZeros("lev_lnt"),reverseSortOrder:!0,width:"3rem",filterable:!flat_view},{displayTitle:"譜面",name:"chart_diff",data:function(e,a,s,t){return 1==flat_view?"sort"===a||"meta"===a?e.chart_diff:convertDifficultyNames(e.chart_diff,!1,ongeki_chart_list):null},className:"lv-name detail-hidden",width:"3rem",createdCell:flat_view?function(e,a,s,t,l){$(e).addClass(s.chart_diff)}:null,render:flat_view?renderChartDifficultyName("chart_diff",!1,ongeki_chart_list):null,customDropdownSortSource:flat_view?sortByDifficultyCategory("chart_diff",ongeki_chart_list):null,filterable:flat_view,visible:!1},{displayTitle:"難易度グループ",name:"chart_lev",data:flat_view?"chart_lev":null,className:"lv detail-hidden",width:"4rem",customDropdownSortSource:sortByLeadingZeros("chart_lev"),reverseSortOrder:!0,visible:!1},{displayTitle:"譜面レベル",name:"chart_lev_i",data:flat_view?"chart_lev_i":null,className:"lv lv-name detail-hidden",render:flat_view?renderChartDifficultyNameAndLv("chart_diff","chart_lev","chart_lev_i","chart_lev_i_display",ongeki_chart_list):null,width:"4rem",createdCell:flat_view?function(e,a,s,t,l){$(e).addClass(s.chart_diff)}:null,searchable:!1,visible:flat_view},{displayTitle:"NEW",name:"new",data:"new",searchable:!1,visible:!1},{displayTitle:"ノート数",name:"chart_notes",data:flat_view?"chart_notes":null,className:"details notecount detail-hidden",width:"6em",searchable:!1,visible:!1},{displayTitle:"ベル",name:"chart_bells",data:flat_view?"chart_bells":null,className:"details notecount detail-hidden",width:"5em",searchable:!1,visible:!1},{displayTitle:"譜面作者",name:"chart_designer",data:flat_view?"chart_designer":null,width:"15em",className:"details detail-hidden",filterable:flat_view,searchable:flat_view,visible:!1},{displayTitle:"追加日",name:"date",data:function(e,a,s,t){return formatDate(e.date)},className:"date",filterable:!0,render:function(e,a,s){return"display"===a?'<div class="inner-wrap">'+e+"</div>":e},reverseSortOrder:!0,width:"4em"},{displayTitle:"BONUS",name:"bonus",data:"bonus",className:"details detail-hidden",width:"10px",searchable:!1}],default_order=flat_view?[[getColumnIndexByName("chart_lev_i"),"desc"],[getColumnIndexByName("chart_diff"),"desc"],[getColumnIndexByName("date"),"desc"]]:[[getColumnIndexByName("date"),"desc"],[getColumnIndexByName("id"),"asc"]];function processOngekiChartData(e,a){return e[a]?{...e,chart_diff:a,chart_lev:e[a],chart_lev_i:parseFloat(e[a+"_i"]||e[a].replace("+",".7")),chart_lev_i_display:e[a+"_i"]||`<span class="approx">${parseFloat(e[a].replace("+",".7")).toFixed(1)}</span>`,chart_notes:e[a+"_notes"],chart_bells:e[a+"_bells"],chart_designer:e[a+"_designer"]}:null}function parseChapId(e,a){var s=e.chap_id,t=s.substr(3,2);if("0"==s.substr(0,1)){var l=s.substr(1,1);if("8"==s.substr(3,1)){var l=s.substr(1,1);t="S"+s.substr(4,1)}return l>"0"?l+"-"+t+(a?" ":""):""}return"70"==s.substr(0,2)?(l="M")+"-"+t+(a?" ":""):"80"==s.substr(0,2)?(l="SP2")+"-"+t+(a?" ":""):"99"==s.substr(0,2)?(l="SP")+"-"+t+(a?" ":""):s+(a?" ":"")}$(document).ready((function(){$.getJSON("data/music-ex.json",(e=>{$("#table").DataTable({data:flattenMusicData(e,flat_view,ongeki_chart_list,processOngekiChartData),buttons:[{extend:"colvis",className:"config-btn",columns:".toggle",text:"カラムON/OFF",collectionTitle:"表示するカラムを選択",collectionLayout:"fixed",fade:150}],columns:columns_params,deferRender:!0,dom:'<"toolbar-group"<"toolbar filters"><"toolbar search"f>><"toolbar secondary"<"info"ilB>><"table-inner"rt><"paging"p>',language:{emptyTable:"テーブルにデータがありません",info:replaceUnitText(" _TOTAL_unit (_START_〜_END_ 表示中)"),infoEmpty:replaceUnitText(" 0 unit"),infoFiltered:replaceUnitText("（全 _MAX_ unit）"),infoPostFix:"",infoThousands:",",lengthMenu:"1ページ表示 _MENU_",loadingRecords:"読み込み中...",processing:"処理中...",search:"検索",searchPlaceholder:"曲名・アーティスト・キャラ",zeroRecords:"一致するレコードがありません",paginate:{sFirst:"先頭",sLast:"最終",sNext:"NEXT",sPrevious:"PREV"},aria:{sSortAscending:": 列を昇順に並べ替えるにはアクティブにする",sSortDescending:": 列を降順に並べ替えるにはアクティブにする"}},lengthMenu:[[25,50,100,-1],[25,50,100,"All"]],order:default_order,responsive:{details:{type:"column",target:"tr",display:$.fn.dataTable.Responsive.display.modal({header:function(e){var a=e.data(),s=encodeURIComponent(a.title.replaceAll("&","＆").replaceAll(":","：").replaceAll("[","［").replaceAll("]","］").replaceAll("#","＃").replaceAll('"',"”")),t="https://wikiwiki.jp/gameongeki/"+s,l=a.wikiwiki_url?a.wikiwiki_url:t;return'<div class="modal-header" style="--img:url(jacket/'+a.image_url+');"><span class="header-img"></span><span class="header-img-overlay"></span><div class="img-wrap"><img src="jacket/'+a.image_url+'"/></div><div class="content-wrap">'+("1"==a.bonus?'<span class="bonus">BONUS</span>':"")+'<span class="title">'+a.title+'</span><span class="artist">'+a.artist+"</span>"+("-"!==a.copyright1?'<span class="copyright">'+a.copyright1.replace(/\s+ピアプロロゴ/,'<span class="piapro">piapro</span>')+"</span>":"")+'<div class="quicklinks"><a class="wiki" href="'+l+'" target="_blank" rel="noopener noreferer nofollow">Wiki</a><a class="youtube" href="https://youtube.com/results?search_query=オンゲキ+譜面確認+'+s+'" target="_blank" rel="noopener noreferer nofollow"></a></div></div></div>'},footer:function(e){var a=e.data();return'<div class="modal-footer"><div class="report"><a class="report-btn" href="https://twitter.com/intent/tweet?text=@zvuc_%0A%E3%80%90%23%E3%82%AA%E3%83%B3%E3%82%B2%E3%82%ADDB%20%E6%83%85%E5%A0%B1%E6%8F%90%E4%BE%9B%E3%80%91%0A%E6%9B%B2%E5%90%8D%EF%BC%9A'+encodeURIComponent(a.title)+'%0A%E8%AD%9C%E9%9D%A2%EF%BC%9A" target="_blank" rel="noopener noreferer nofollow">💬 足りない情報・間違いを報告する （Twitter）</a></div></div>'}}),renderer:function(e,a,s){var t=e.row(a).data(),l=t.chara_id,r=t.enemy_type,i=""!==t.lev_lnt?"lunatic":"",n=$.map(s,(function(e,a){columns_params[e.columnIndex];if(!e.className.includes("detail-hidden")&&!e.className.includes("lv ")&&!e.className.includes("chara "))return'<div class="row '+e.className+'" data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><span class="row-label">'+e.title+"</span> <span>"+e.data+"</span></div>"})).join(""),d=$.map(s,(function(e,a){var s=columns_params[e.columnIndex];if(!e.className.includes("detail-hidden")&&e.className.includes("chara "))return'<div class="row '+e.className+'" data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><span class="row-label">'+s.displayTitle+"</span> <span>"+e.data+"</span></div>"})).join(""),c=$.map(s,(function(e,a){var s=columns_params[e.columnIndex];if(!e.className.includes("detail-hidden")&&e.className.includes("lv ")){var l=s.name,r=l.concat("_notes"),i=l.concat("_bells"),n=l.concat("_designer"),d=l.concat("_chart_link");return'<div class="row '+e.className+'" data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><span class="row-label"><span>'+s.displayTitle+'</span></span> <span class="content-col"><span class="main-info-wrap">'+e.data+'</span><span class="sub-info-wrap">'+(checkPropertyAndValueExists(t,r)?'<span class="notes"><span class="label">Chain</span><span>'+t[r]+"</span></span>":"")+(checkPropertyAndValueExists(t,i)?'<span class="bells"><span class="label">Bell</span><span>'+t[i]+"</span></span>":"")+(checkPropertyAndValueExists(t,n)?'<span class="designer"><span class="label">Designer</span><span>'+t[n]+"</span></span>":"")+"</span></span>"+(checkPropertyAndValueExists(t,d)?'<span class="chart-link"><a class="btn chartlink" target="_blank" rel="noopener noreferrer" href="https://sdvx.in/ongeki/'+t[d]+'.htm"><span class="img"></span><span>譜面確認</span></a><span class="chart-provider">sdvx.in 提供</span></span>':"")+"</div>"}})).join(""),o=$('<div class="table-wrapper"/>').append($('<div class="details-table chara-details"/>').append('<div class="table-header"><span class="th-label">CHARACTER</span></div>').append(d).append("1"==l.substr(0,1)?'<span class="chara-img '+r.toLowerCase()+'" style="--chara-img: url(\'./img/chara/'+l+".png');\"></span>":"")).append($('<div class="details-table chart-details '+i+'"/>').append('<div class="table-header"><span class="th-label">CHART</span></div>').append(c)).append($('<div class="details-table misc-details"/>').append('<div class="table-header"><span class="th-label">SONG METADATA</span></div>').append(n));return o||!1}}},rowGroup:{dataSrc:"date",startRender:flat_view||""!=searchParams?null:function(e,a){return"<div>"+formatDate(a,"JP")+" 追加</div>"}},scrollX:!0,initComplete:function(){tableInitCompleteFunctions(this)}})}))}));
