const colorSchemeInput=document.querySelectorAll('input[name="colorScheme"]'),langOptionInput=document.querySelectorAll('input[name="siteLanguage"]'),gameRegionChecks=document.querySelectorAll('input[name="gameRegion"]'),gameRegionQuickSwitch=document.getElementById("gameRegionQuickSwitch");let userLanguage=localStorage.getItem("userLanguage"),cachedTranslations=localStorage.getItem("translations");var currentRegion=localStorage.getItem("userGameRegion");currentRegion||localStorage.setItem("userGameRegion","jp");const initialGameRegion=currentRegion||"jp";function updateChartLevelSelectboxValue(e){var t=e.get("chart_lev");if(null!==t){var n=unescapeSlashes(t);document.querySelector("select#chart_lev").value=n}}function unescapeSlashes(e){if(null!==e){let t=e.replace(/(^|[^\\])(\\\\)*\\$/,"$&\\");try{t=JSON.parse(`"${t}"`)}catch(t){return e}return e.replace(/(^|[^\\])(\\\\)*\\$/,"$&\\")}return e}function loadTranslations(){return new Promise(((e,t)=>{fetch("../shared/translations/translations.json").then((e=>e.json())).then((t=>{sessionStorage.setItem("translations",JSON.stringify(t)),e()})).catch((e=>{console.error("Error loading translations:",e),t(e)}))}))}function getTranslation(e,t){const n=sessionStorage.getItem("translations");if(n){const a=JSON.parse(n);if(a[e]&&a[e][t])return a[e][t]}}function applyTranslations(e,t){const n=e[t];document.querySelectorAll("[data-i18n]").forEach((e=>{const t=e.getAttribute("data-i18n");n[t]&&(e.innerText=n[t])}))}function setLanguage(e){const t=document.querySelector('input[name="siteLanguage"]:checked').value,n=document.querySelector("#site-menu .menu-list-item.lang-settings");return e&&n.classList.add("setting-changed"),localStorage.setItem("userLanguage",t),document.documentElement.setAttribute("data-lang",t),applyTranslations(JSON.parse(cachedTranslations),t),Promise.resolve()}function initTranslations(){if(userLanguage||(localStorage.setItem("userLanguage","ja"),userLanguage="ja",console.log("initialized userLanguage to ja")),!cachedTranslations)return loadTranslations().then((()=>{cachedTranslations=sessionStorage.getItem("translations"),applyTranslations(JSON.parse(cachedTranslations),userLanguage)})).catch((e=>console.error("Error setting language:",e)))}document.querySelector(`input[value="${initialGameRegion}"]`).checked=!0,gameRegionQuickSwitch.checked="jp"!==initialGameRegion,document.documentElement.setAttribute("data-game-region",currentRegion),document.addEventListener("DOMContentLoaded",(function(){updateChartLevelSelectboxValue(new URLSearchParams(window.location.search))}));
