const root=document.documentElement,toggleSwitch=document.getElementById("themeToggleCheckbox");window.matchMedia("(prefers-color-scheme: dark)").matches&&(toggleSwitch.checked=!1,root.setAttribute("data-theme","dark")),window.matchMedia("(prefers-color-scheme: light)").matches&&(toggleSwitch.checked=!0,root.setAttribute("data-theme","light"));const getTransitionEvent=()=>{const t=document.createElement("fakeelement"),e={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(const n in e)if(void 0!==t.style[n])return e[n]},transitionEvent=getTransitionEvent();function switchTheme(t){root.classList.toggle("transitioning"),t.target.checked?root.setAttribute("data-theme","light"):root.setAttribute("data-theme","dark"),root.addEventListener(transitionEvent,transitionEndCallback)}function updateQueryStringParameter(t,e){var n=new URLSearchParams(window.location.search);if("URLSearchParams"in window){""===e?n.delete(t):n.set(t,e);var a=window.location.pathname+"?"+n.toString();history.pushState(null,"",a)}}function clearQueryStringParameter(){new URLSearchParams(window.location.search);if("URLSearchParams"in window){var t=window.location.pathname;history.pushState(null,"",t)}}function appendSelectboxStateClass(t,e){""!==e?t.addClass("changed"):t.removeClass("changed")}function replaceUnitText(t){var e=flat_view?"譜面":"曲";return t.replace("unit",e)}toggleSwitch.addEventListener("change",switchTheme,!1),transitionEndCallback=t=>{root.removeEventListener(transitionEvent,transitionEndCallback),root.classList.remove("transitioning")},$(document).ready((function(){function t(){dataLayer.push(arguments)}"URLSearchParams"in window&&updateChartLevelSelectboxValue(searchParams),$("html").removeClass("page-loading"),window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","UA-141271073-1"),t("config","G-YZ8GJR7QFL")}));
var searchParams=new URLSearchParams(window.location.search);function checkPropertyAndValueExists(a,n){return!!a.hasOwnProperty(n)&&""!==a[n]}function sortLevels(a,n){return function(e,r,s,t){return"sort"===r?""===e[n]?addLeadingZero(e[a]):addLeadingZero(e[n]):e[a]}}function addLeadingZero(a){return""!=a?(lev_processed=parseInt(a)<10?"0"+a:a,lev_processed):""}function sortByLeadingZeros(a){return function(n,e){return addLeadingZero(n[a]).localeCompare(addLeadingZero(e[a]))}}function renderLvNum(a,n){return function(e,r,s){if("display"===r){var t=s[a].match(/^([0-9]{1,2})(\+)?$/);if(t){var i=t[1];return"+"===t[2]?`<div class="inner-wrap"><span class="lv-num-simple"><span class="num">${i}</span><span class="plus">+</span></span><span class="lv-num-precise">${s[n]}</span></div>`:`<div class="inner-wrap"><span class="lv-num-simple"><span class="num">${i}</span></span><span class="lv-num-precise">${s[n]}</span></div>`}return`<div class="inner-wrap"><span class="lv-num-simple"><span class="num">${s[a]}</span></span><span class="lv-num-precise">${s[n]}</span></div>`}return e}}function renderChartDifficultyNameAndLv(a,n,e,r,s){return function(e,t,i){if("display"===t){var o=convertDifficultyNames(i[a],!1,s),l="we_kanji"===i[a]?"☆"+i[r]:i[r],c=i[n].match(/^([0-9]{1,2})(\+)?$/);if(c){var p=c[1];return"+"===c[2]?`<div class="inner-wrap"><span class="diff-name">${o}</span><span class="lv-num-wrap"><span class="lv-num-simple"><span class="num">${p}</span><span class="plus">+</span></span><span class="lv-num-precise">${l}</span></span></div>`:`<div class="inner-wrap"><span class="diff-name">${o}</span><span class="lv-num-wrap"><span class="lv-num-simple"><span class="num">${p}</span></span><span class="lv-num-precise">${l}</span></span></div>`}return`<div class="inner-wrap"><span class="diff-name">${o}</span><span class="lv-num-wrap"><span class="lv-num-simple"><span class="num">${i[n]}</span></span><span class="lv-num-precise">${l}</span></span></div>`}return e}}function renderChartLinkBtn(a){return function(a,n,e){return"display"===n?chartLinkBtn(e.chart_link):a}}function chartLinkBtn(a){return""!==a?`<a class="btn chartlink" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();" href="https://sdvx.in/chunithm/${a}.htm">\n                    <span class="img"></span><span>譜面確認</span>\n                </a><span class="chart-provider">sdvx.in 提供</span>`:""}function renderChartDifficultyName(a,n){return function(e,r,s){return"display"===r?'<span class="diff-name">'+convertDifficultyNames(s[a],!1,n)+"</span>":e}}function convertDifficultyNames(a,n,e){const r=e[a];return n?`${Object.keys(e).indexOf(a)+1} ${r}`:r}function sortByDifficultyCategory(a,n){return function(e,r){return convertDifficultyNames(e[a],!0,n).localeCompare(convertDifficultyNames(r[a],!0,n))}}function renderInWrapper(){return function(a,n,e){return"display"===n?'<div class="inner-wrap">'+a+"</div>":a}}function flattenMusicData(a,n,e,r){return n?a.map((a=>Object.keys(e).map((n=>r(a,n))))).flat().filter((a=>!!a)):a}function formatDate(a,n){var e=a.slice(0,4),r=a.slice(4,6),s=a.slice(6,8),t=`${e}-${r}-${s}`;if("JP"==n)var i=((new Date).getFullYear()==e?"":e+"/")+`${r}/${s}(${["日","月","火","水","木","金","土"][new Date(t).getDay()]})`;else i=t;return i}function getColumnIndexByName(a){return columns_params.findIndex((function(n){return n.name===a}))}function tableInitCompleteFunctions(a){generateFilterDropdowns(a),applyFilterFromURLSearchParams(a,searchParams),a.on("order.dt",(function(){toggleDateRowGroup(a)})),$("#table").addClass("loading-done"),$("html").removeClass("table-loading"),$("#table").on("column-visibility.dt",(function(){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()})),$("select#chart_lev").on("change",(function(){var n=$(this),e=$(this).val(),r=$.fn.dataTable.util.escapeRegex($(this).val());"filter"==n.data("type")?(a.api().column("chart_lev:name").search(r?"^"+r+"$":"",!0,!1),updateQueryStringParameter("chart_lev",e),a.api().draw()):window.location.href="./lv?chart_lev="+encodeURIComponent(e)})),$("button.reset-search").on("click",(function(){a.api().order(default_order).search("").columns().search("").draw(),clearQueryStringParameter(),toggleDateRowGroup(a),$(".toolbar.filters select").prop("selectedIndex",0).removeClass("changed")}))}function generateFilterDropdowns(a){var n=a.api().rows().data();a.api().columns().every((function(){var e=a.api().order(),r=this,s=r.data(),t=columns_params[r.index()];if("filterable"in t&&1==t.filterable){var i=$('<div class="select-wrap '+t.className+'"><span class="label">'+t.displayTitle+"</span></div>").appendTo($(".toolbar.filters")),o=$('<select id="'+t.name+'"><option value="" data-default>——</option></select>');if(o.appendTo(i),o.on("change",(function(){var a=$(this).val(),n=$.fn.dataTable.util.escapeRegex($(this).val());appendSelectboxStateClass($(this),a),r.index()===getColumnIndexByName("date")||""===n&&e[0][0]===getColumnIndexByName("date")?r.rowGroup().enable():r.rowGroup().disable(),updateQueryStringParameter(t.name,a),r.search(n?"^"+n+"$":"",!0,!1).draw()})),s=t.customDropdownSortSource?s.map((function(a,n){return n})).sort((function(a,e){var r=n[a],s=n[e];return"function"==typeof t.customDropdownSortSource?t.customDropdownSortSource(r,s):r[t.customDropdownSortSource].localeCompare(s[t.customDropdownSortSource])})).map((function(a){return s[a]})):s.sort(),t.reverseSortOrder&&s.reverse(),s.unique().each((function(a,n){""!=a&&o.append('<option value="'+a+'">'+a+"</option>")})),"URLSearchParams"in window){var l=searchParams.get(t.name);if(null!==l){var c=unescapeSlashes(l);s.unique().each((function(a){o.val(c)})),appendSelectboxStateClass(o,c)}}}}))}function applyFilterFromURLSearchParams(a,n){"URLSearchParams"in window&&(n.forEach((function(e,r){a.api().columns().every((function(){var a=columns_params[this.index()],e=n.get(a.name),r=$.fn.dataTable.util.escapeRegex(decodeURIComponent(e));null!==e&&this.search(e?"^"+r+"$":"",!0,!1)}))})),a.api().draw())}function toggleDateRowGroup(a){var n=a.api().order(),e=a.api().columns().search(),r=!1;for(let a=0;a<e.length;a+=1)if(a in e&&""!==e[a]){r=!0;break}return n[0][0]!==getColumnIndexByName("date")?void a.api().rowGroup().disable():n[0][0]!==getColumnIndexByName("date")||r?void 0:void a.api().rowGroup().enable()}
